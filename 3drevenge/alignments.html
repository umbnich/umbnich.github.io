<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>3DRevenge - Alignments</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 40px;
      padding: 20px;
    }

    .grid-section {
      text-align: center;
    }

    h1 {
      margin-bottom: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      max-width: 600px;
    }

    .cell {
      border: 1px solid #999;
      padding-top: 70%;
      position: relative;
      background-color: #f8f8f8;
    }

    .label {
      position: absolute;
      top: 5px;
      left: 5px;
      font-size: 12px;
      color: #555;
    }

    .subgrid {
      position: absolute;
      inset: 0;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
    }

    .subcell {
      border: 0;
      position: relative;
    }

    .icon {
      position: absolute;
      font-size: 18px;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .sidebar {
      width: 250px;
      font-size: 14px;
    }

    .sidebar h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }

    .history-entry {
      margin-bottom: 10px;
    }
  </style>

  <script>
    // Accesso
    if (!sessionStorage.getItem("loggedIn")) {
      alert("Accesso negato! Torna al login.");
      window.location.href = "index.html";
    }

    const currentUser = sessionStorage.getItem("username");

    const userIcons = {
      "admin": "üõ°Ô∏è",
      "manuel.fortunato": "‚öîÔ∏è",
      "francesco.buffone": "üßô",
      "sara.serratore": "üêâ",
      "umbs": "üßù‚Äç‚ôÇÔ∏è",
      "francesca.mazzuca": "üßù‚Äç‚ôÄÔ∏è"
    };

    const userPositions = {
      "admin": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 },
      "manuel.fortunato": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 },
      "francesco.buffone": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 },
      "sara.serratore": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 },
      "umbs": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 },
      "francesca.mazzuca": { mainRow: 1, mainCol: 1, subRow: 1, subCol: 1 }
    };

    const previousPositions = {
      "admin": { from: "Neutral", to: "Lawful Neutral" },
      "manuel.fortunato": { from: "Neutral", to: "Neutral Good" },
      "francesco.buffone": { from: "Neutral", to: "Chaotic Good" },
      "sara.serratore": { from: "Neutral", to: "Neutral Evil" },
      "umbs": { from: "Neutral", to: "Neutral Good" },
      "francesca.mazzuca": { from: "Neutral", to: "Chaotic Neutral" }
    };

    function generateCellId(mainRow, mainCol, subRow, subCol) {
      return `cell-${mainRow}-${mainCol}-${subRow}-${subCol}`;
    }

    window.onload = function () {
      // Posiziona tutti gli utenti nella griglia
      for (const user in userIcons) {
        const pos = userPositions[user];
        const icon = document.createElement("div");
        icon.className = "icon";
        icon.textContent = userIcons[user];

        const cellId = generateCellId(pos.mainRow, pos.mainCol, pos.subRow, pos.subCol);
        const target = document.getElementById(cellId);
        if (target) target.appendChild(icon);
      }

      // Mostra cronologia movimenti nella sidebar
      const historyContainer = document.getElementById("history");

      for (const user in previousPositions) {
        const { from, to } = previousPositions[user];
        const icon = userIcons[user] || "‚ùì";

        const entry = document.createElement("div");
        entry.className = "history-entry";
        entry.innerText = `${icon} ${user}: ${from} ‚Üí ${to}`;
        historyContainer.appendChild(entry);
      }
    };
  </script>
</head>
<body>
  <div class="grid-section">
    <h1>Tabella Allineamenti D&D</h1>
    <div class="grid">
      <!-- Riga 0 -->
      <div class="cell"><span class="label">Lawful Good</span><div class="subgrid">
        <div class="subcell" id="cell-0-0-0-0"></div>
        <div class="subcell" id="cell-0-0-0-1"></div>
        <div class="subcell" id="cell-0-0-0-2"></div>
        <div class="subcell" id="cell-0-0-1-0"></div>
        <div class="subcell" id="cell-0-0-1-1"></div>
        <div class="subcell" id="cell-0-0-1-2"></div>
        <div class="subcell" id="cell-0-0-2-0"></div>
        <div class="subcell" id="cell-0-0-2-1"></div>
        <div class="subcell" id="cell-0-0-2-2"></div>
      </div></div>

      <div class="cell"><span class="label">Neutral Good</span><div class="subgrid">
        <div class="subcell" id="cell-0-1-1-1"></div>
      </div></div>

      <div class="cell"><span class="label">Chaotic Good</span><div class="subgrid"></div></div>

      <!-- Riga 1 -->
      <div class="cell"><span class="label">Lawful Neutral</span><div class="subgrid">
        <div class="subcell" id="cell-1-0-1-1"></div>
      </div></div>

      <div class="cell"><span class="label">Neutral</span><div class="subgrid">
        <div class="subcell" id="cell-1-1-0-0"></div>
        <div class="subcell" id="cell-1-1-0-1"></div>
        <div class="subcell" id="cell-1-1-0-2"></div>
        <div class="subcell" id="cell-1-1-1-0"></div>
        <div class="subcell" id="cell-1-1-1-1"></div> <!-- centro -->
        <div class="subcell" id="cell-1-1-1-2"></div>
        <div class="subcell" id="cell-1-1-2-0"></div>
        <div class="subcell" id="cell-1-1-2-1"></div>
        <div class="subcell" id="cell-1-1-2-2"></div>
      </div></div>

      <div class="cell"><span class="label">Chaotic Neutral</span><div class="subgrid">
        <div class="subcell" id="cell-1-2-1-1"></div>
      </div></div>

      <!-- Riga 2 -->
      <div class="cell"><span class="label">Lawful Evil</span><div class="subgrid"></div></div>
      <div class="cell"><span class="label">Neutral Evil</span><div class="subgrid">
        <div class="subcell" id="cell-2-1-1-1"></div>
      </div></div>
      <div class="cell"><span class="label">Chaotic Evil</span><div class="subgrid"></div></div>
    </div>
  </div>

  <div class="sidebar">
    <h2>Movimenti recenti</h2>
    <div id="history"></div>
  </div>
</body>
</html>
